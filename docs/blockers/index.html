<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <title>cPanel elevate documentation | Known cPanel ELevate Blockers</title>
    <link rel=icon href="https://cpanel.github.io/elevate/images/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,800|Open+Sans:400,700,800" rel="stylesheet">
    <script type="text/javascript" src="https://cpanel.github.io/elevate/js/jquery-3.4.1.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cpanel.github.io/elevate/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cpanel.github.io/elevate/sass/main.min.css">
    <link rel="stylesheet" type="text/css" href="https://cpanel.github.io/elevate/css/style.css">
</head><body><nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="https://cpanel.github.io/elevate">
            <img src="https://cpanel.github.io/elevate/images/elevate-logo.svg" alt="cPanel elevate">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
            aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon "></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">

                
                <li class="nav-item"></li>
                <a class="nav-link" href="https://docs.cpanel.net/knowledge-base/technical-support-services/how-to-open-a-technical-support-ticket/">
                    
                    Report an Issue
                </a>
                </li>
                
                <li class="nav-item"></li>
                <a class="nav-link" href="https://github.com/cpanel/elevate">
                    
                    Contribute
                </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>
<div id="content">
    <div class="container">
        <ol class="d-none d-md-flex breadcrumb">
            <li class="breadcrumb-item">
                <a href="https://cpanel.github.io/elevate">Home</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
                Known cPanel ELevate Blockers
            </li>
        </ol>
    </div>
</div>
<br><div id="content">
<div id="content">
    <div class="container">

        <div class="row"><div class="d-none d-md-block col-md-3">
    <aside class="side-nav sticky">
        <h4 class="mt-1">Elevate cPanel</h4>
        <div class="installation-contents-wrapper">

            <ul class="installation-list">
                <li><a class="btn btn-primary" role="button" href="https://github.com/cpanel/elevate">GitHub
                        Repository</a></li>
                <li><a class="btn btn-primary" role="button"
                        href="https://docs.cpanel.net/knowledge-base/technical-support-services/how-to-open-a-technical-support-ticket/">Issues</a></li>
                <li><a class="btn btn-primary" role="button" href="https://cpanel.github.io/elevate">Documentation</a></li>
                
                <a href="/elevate/#introduction">
                    
                    <li>Introduction</li>
                </a>
                
                <a href="/elevate/#before-updating">
                    
                    <li>Before Updating</li>
                </a>
                
                <a href="/elevate/#risks">
                    
                    <li>Risks</li>
                </a>
                
                <a href="/elevate/#using-the-script">
                    
                    <li>Using the script</li>
                </a>
                
                <a href="/elevate/#sumup-of-upgrade-process">
                    
                    <li>SumUp of upgrade process</li>
                </a>
                
                <a href="/elevate/#copyright">
                    
                    <li>Copyright</li>
                </a>
                
                <li>
                    <a class="btn btn-primary" role="button" href="https://cpanel.github.io/elevate/#faq">FAQ</a>
                </li>
                <li><a class="btn btn-primary" role="button" href="https://cpanel.github.io/elevate/blockers">Known Blockers</a></li>
                <li><a class="btn btn-primary" role="button" href="https://cpanel.github.io/elevate/whitepaper">White Paper</a></li>
            </ul>
        </div>

    </aside>
</div>
<div class="col-md-9">

                <article
                    class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray">
                    <h1 id="known-blockers">Known Blockers</h1>
<p>The following is a list of install states which the script will intentionally prevent you from upgrading with. This is because the script cannot guarantee a successful upgrade with these conditions in place.</p>
<h2 id="basic-checks">Basic checks</h2>
<p>The following conditions are assumed to be in place any time you run this script:</p>
<ul>
<li>You are logged in as <strong>root</strong>.</li>
<li>The system is running <strong>CentOS</strong> or <strong>CloudLinux</strong> 7.9.</li>
<li>You have cPanel version 110 installed.</li>
<li>cPanel does not require an update.</li>
<li>cPanel has a valid license.</li>
<li><strong>CloudLinux</strong> has a valid license (if applicable).</li>
<li>The <code>elevate-cpanel</code> script must be running from: <code>/scripts</code> or <code>/usr/local/cpanel/scripts</code></li>
<li>The <code>elevate-cpanel</code> script must be up to date.</li>
</ul>
<h2 id="conflicting-processes">Conflicting Processes</h2>
<p>The following processes are known to conflict with this script and cannot be executed simultaneously.</p>
<ul>
<li><code>/usr/local/cpanel/scripts/upcp</code></li>
<li><code>/usr/local/cpanel/bin/backup</code></li>
</ul>
<p><strong>NOTE</strong> These checks are only enforced when the script is executed in start mode</p>
<h2 id="disk-space">Disk space</h2>
<p>At any given time, the upgrade process may use at or more than 5 GB. If you have a complex mount system, we have determined that the following areas may require disk space for a period of time:</p>
<ul>
<li><strong>/boot</strong>: 120 MB</li>
<li><strong>/usr/local/cpanel</strong>: 1.5 GB</li>
<li><strong>/var/lib</strong>: 5 GB</li>
</ul>
<h2 id="things-you-need-to-upgrade-first">Things you need to upgrade first.</h2>
<p>You can discover many of these issues by downloading <code>elevate-cpanel</code> and running <code>/scripts/elevate-cpanel --check</code>. Below is a summary of the major blockers people might encounter.</p>
<ul>
<li><strong>cPanel is up to date</strong>
<ul>
<li>You will need to be on a version mentioned in the &ldquo;Latest cPanel &amp; WHM Builds (All Architectures)&rdquo; section at <a href="http://httpupdate.cpanel.net/">http://httpupdate.cpanel.net/</a></li>
<li>Mitigation: <code>/usr/local/cpanel/scripts/upcp</code></li>
</ul>
</li>
<li><strong>MySQL</strong>
<ul>
<li>If the version of MySQL/MariaDB installed on the system is not supported on RHEL 8 based distributions, you <strong>must</strong> upgrade to a supported version. If cPanel manages the MySQL installation, we will offer to upgrade MySQL automatically to MariaDB 10.6 during elevation.</li>
<li>Elevation will block if a MySQL upgrade is in progress.</li>
<li>The system <strong>must</strong> not be setup to use a remote database server.</li>
</ul>
</li>
<li>Some <strong>EA4 packages</strong> are not supported on AlmaLinux 8.
<ul>
<li>Example: Ruby 2.4 is available on CentOS 7 but not AlmaLinux 8.  You would need to remove these packages before upgrading.  Doing so might impact your system users.  Proceed with caution.</li>
<li>PHP versions 5.4 through 7.1 are available from cPanel on CentOS 7 but not AlmaLinux 8.
<ul>
<li>If they are in use by any system users, we block the elevation from proceeding.</li>
<li>If they are <strong>not</strong> in use, we allow the elevation to proceed and these versions of PHP will not be installed after the elevation completes.</li>
</ul>
</li>
<li>If you have Imunify 360 installed, then it can provide hardened PHP for versions 5.1 through 7.1 on AlmaLinux 8 as well as CentOS 7.  We now detect that these PHP versions are provided by Imunify 360 and allow the elevation to proceed.</li>
</ul>
</li>
<li>The system <strong>must</strong> be able to control the boot process by changing the GRUB2 configuration.
<ul>
<li>The reason for this is that the Leapp framework, which performs the upgrade of distribution-provided software, needs to be able to run a custom early boot environment (initrd) in order to safely upgrade the distribution.</li>
<li>We check for this by seeing whether the kernel the system is currently running is the same version as that which the system believes is the default boot option.</li>
<li>We also check that there is a valid GRUB2 config.</li>
</ul>
</li>
<li>We block if your machine has multiple network interface cards (NICs) using kernel-names (<code>ethX</code>).
<ul>
<li>Since <code>ethX</code> style names are automatically assigned by the kernel, there is no guarantee that this name will remain the same upon upgrade to a new kernel version tier.</li>
<li>The &ldquo;default&rdquo; approach in <code>network-scripts</code> config files of specifying NICs by <code>DEVICE</code> can cause issues due to the above.</li>
<li>A more in-depth explanation of <em>why</em> this is a problem (and what to do about it) can be found at <a href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/">freedesktop.org</a>.</li>
<li>One way to prevent these issues is to assign a custom name in the configuration and re-initialize NICs ahead of time.</li>
</ul>
</li>
<li>Running the system in a container-like environment is not supported.</li>
<li>If running JetBackup, it <strong>must</strong> be version 5 or greater. Earlier versions are not supported.</li>
<li>On <strong>CentOS</strong> 7, the system <strong>must not</strong> have Python 3.6 installed; this will interfere with the upgrade. On <strong>CloudLinux</strong> this is not an issue.</li>
<li>Elevation will block if the <code>sshd</code> config file is absent or unreadable.</li>
<li>These issues with the YUM repositories can cause ELevate to block:
<ul>
<li>Invalid syntax or use of <code>\$</code>. That character is interpolated on RHEL 7 based systems but not on systems that are RHEL 8 based.</li>
<li>Any unsupported repositories that have packages installed</li>
<li>If YUM is in an unstable state (running <code>yum makecache</code> fails).</li>
</ul>
</li>
</ul>
<h1 id="other-known-issues">Other Known Issues</h1>
<p>The following is a list of other known issues that could prevent your server&rsquo;s successful elevation.</p>
<h2 id="filesystem">Filesystem</h2>
<p>Since Elevate needs to reboot your system multiple times as part of the upgrade process, we ensure that the command <code>mount -a</code> succeeds before allowing the elevation to proceed.  The reason for this is that we need to be able to trust that the filesystem remains the same between each reboot.</p>
<h2 id="postgresql">PostgreSQL</h2>
<p>If you are using the PostgreSQL software provided by your distribution (which includes PostgreSQL as installed by cPanel), ELevate will upgrade the software packages. However, your PostgreSQL service is unlikely to start properly. The reason for this is that ELevate will <strong>not</strong> attempt to update the data directory being used by your PostgreSQL instance to store settings and databases; and PostgreSQL will detect this condition and refuse to start, to protect your data from corruption, until you have performed this update.</p>
<p>To ensure that you are aware of this requirement, if it detects that one or more cPanel accounts have associated PostgreSQL databases, ELevate will block you from beginning the upgrade process until you have created a file at <code>/var/cpanel/acknowledge_postgresql_for_elevate</code>.</p>
<h3 id="updating-the-postgresql-data-directory">Updating the PostgreSQL data directory</h3>
<p>Once ELevate has completed, you should then perform the update to the PostgreSQL data directory. Although we defer to the information <a href="https://www.postgresql.org/docs/10/pgupgrade.html">in the PostgreSQL documentation itself</a>, and although <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/using-databases#migrating-to-a-rhel-8-version-of-postgresql_using-postgresql">Red Hat has provided steps in their documentation</a> which should be mostly applicable to all distros derived from RHEL 8, we found that the following steps worked in our testing to update the PostgreSQL data directory. (Please note that these steps assume that your server&rsquo;s data directory is located at <code>/var/lib/pgsql/data</code>; your server may be different. You should also consider making a backup copy of your data directory before starting, because <strong>cPanel cannot guarantee the correctness of these steps for any arbitrary PostgreSQL installation</strong>.)</p>
<ol>
<li>Install the <code>postgresql-upgrade</code> package: <code>dnf install postgresql-upgrade</code></li>
<li>Within your PostgreSQL config file at <code>/var/lib/pgsql/data/postgresql.conf</code>, if there exists an active option <code>unix_socket_directories</code>, change that phrase to read <code>unix_socket_directory</code>. This is necessary to work around a difference between the CentOS 7 PostgreSQL 9.2 and the PostgreSQL 9.2 helpers packaged by your new operating system&rsquo;s <code>postgresql-upgrade</code> package.</li>
<li>Invoke the <code>postgresql-setup</code> tool: <code>/usr/bin/postgresql-setup --upgrade</code>.</li>
<li>In the root user&rsquo;s WHM, navigate to the &ldquo;Configure PostgreSQL&rdquo; area and click on &ldquo;Install Config&rdquo;. This should restore the additions cPanel makes to the PostgreSQL access controls in order to allow phpPgAdmin to function.</li>
</ol>
<h2 id="using-ovh-proactive-intervention-monitoring">Using OVH proactive intervention monitoring</h2>
<p>If you are using a dedicated server hosted at OVH, you should <strong>disable the <code>proactive monitoring</code> before starting</strong> the elevation process.  To indicate you have done this, you must create the touch file <code>/var/cpanel/acknowledge_ovh_monitoring_for_elevate</code> or elevation will block when it detects that the system is hosted by OVH.
The proactive monitoring incorrectly detects an issue on your server during one of the reboots.
Your server would then boot to a rescue mode, interrupting the elevation upgrade.</p>
<p><a href="https://support.us.ovhcloud.com/hc/en-us/articles/115001821044-Overview-of-OVHcloud-Monitoring-on-Dedicated-Servers">Read more about OVH monitoring</a></p>
<h1 id="leapp-preupgrade-dry-run-check">Leapp preupgrade (dry run) check</h1>
<p>If no issues are found, Elevate will perform one more check before performing the upgrade: it will perform a &ldquo;dry run&rdquo; of the Leapp upgrade by executing <code>leapp preupgrade</code>.  This will point out any problems that Leapp would encounter during the actual upgrade.  If any errors are found, they will need to be addressed before performing the upgrade.  This test is only performed when the script is invoked with the &ndash;start option.</p>

                </article>

            </div>
        </div>
    </div>
</div>

        </div><script type="text/javascript" src="https://cpanel.github.io/elevate/js/copy-code.js"></script>
<footer class="text-center mt-0">
    <div class="container">
    <div class="row">
    <div class="col-md-1">
    <a href="//cpanel.com" title="cPanel, L.L.C." class="center-block cPanel-logo">
    <img src="https://docs.cpanel.net/img/cpanel-logo.min.svg" title="cPanel, L.L.C." />
    </a>
    </div>
    <div class="col-md-11 legal">
    <p class="small">
    &copy; 2024 cPanel L.L.C.
    </p>
    </div>
    </div>
    </div>
    <div class="container-fluid trademark">
    <div class="row">
    <div class="col-sm-12 text-center">
    <small>
        cPanel, WebHost Manager and WHM are registered trademarks of cPanel, L.L.C. for providing its computer software that facilitates the management and configuration of internet web servers.
        <br><i>page generated at May 29, 2024 at 18:18 (UTC)</i>
    </small>
    </div>
    </div>
    </div>
</footer></body>
</html>
